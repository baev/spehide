## Spehide
*Speak & hide*

### Частично децентрализованный (гибридный) VOIP чат

Использует сервер для координации работы, поиска или предоставления информации о существующих машинах сети и их статусе. Однако сервер не хранит никакой частной информации о клиентах.

Стоит заметить, что подключаться можно сразу к нескольким серверам. *Серверы между собой не синхронизируются и ничего не знаю друг о друге*. Все запросы будут происходить ко всем подключенным серверам одновременно.

### Описание работы

* Пользователь подключается к серверу. Для этого нужно ввести адрес сервера, свой логин и пароль. Если пользователя с таким логином еще нет, регистрация произойдет автоматически.
* Пользователь может добавлять друзей в контак лист. Чтобы добавить друга, надо указать его логин и публичный ключ. Если ключ будет неверный, пользователь не сможет видеть статус друга и не сможет ему звонить.
* Пользователь может позвонить другу в сети. У друга появиться приглашение в разговор, которое он может принять или отклонить.
* В любой момент пользователь может прервать разговор, нажав кнопку **drop**

### Сервер

Хранит аутентификационные данные пользователей (login + pass) и список адресов пользователей (userUid + publicKey + address). 

От клиента серверу могут приходить следующие сообщения:

#### Auth me please (TCP)

* Клиент присылает **логин** и **пароль**
* Если пользователь с данным логином существует, происходит проверка пароля, иначе создается новый пользователь
* В случае *успешной аутентификации* клиенту возвращается (**privateKey + publicKey + userUid**)

#### I'm alive! (UDP)

* Клинет посылает свой uid, privateKey в timestamp
* В случае, если *privateKey верный для данного uid*, сервер запоминает **адрес** клиента и **timestamp**.

#### Is user online? (TCP)

* Клиент посылает **uid и publicKey** пользователя, статус которого хочет узнать
* В случае, если *publicKey верный для данного uid*, и при наличии актуального адреса, **сервер возвращает адрес пользователя**

### Клинет

Хранит список контактов (в виде **uid + publicKey + address + someInfo**) и информацию о себе (**nickname, name, surname etc**).

Чтобы добавить пользователя в список контактов, надо знать его publicKey. Притом, ничего не мешает добавить пользователя с неправильным ключем. Просто данные об этом пользователе не будут поступать.

Может сделать запрос другому пользователю

#### Who are you? (UDP)

* Посылает другому пользователю свой **uid** и его **publicKey**.
* Получив такое сообщение, *сверяет свой publicKey и наличие пользователя (по uid) в своем списке контактов* (?). Если все правильно - посылает сообщение, **содержащее информацию о себе**.

Также, может совершить **голосовой вызов одному или нескольким контактам**. 
